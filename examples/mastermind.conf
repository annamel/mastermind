{
    "dnet_log": "/var/log/mastermind/mastermind.log",
    "dnet_log_mask": 31,

    "disown_timeout": 2,

    "elliptics": {
        "nodes": [
            ["node1.elliptics.mystorage.com", 1025, 2],
            ["node2.elliptics.mystorage.com", 1025, 2]
        ],
        "wait_timeout": 5,
        "monitor_port": 10025
    },

    "monitor": {
        "pool_size": 5,
        "connect_timeout": 5,
        "request_timeout": 5,
        "max_http_clients": 30
    },

    "gzip": {
        "compression_level": 1
    },

    "reserved_space": 112742891520,

    "elliptics_base_port": 1024,
    "elliptics_base_storage_path": "/srv/storage/",

    "net_thread_num": 1,
    "io_thread_num": 1,
    "nonblocking_io_thread_num": 1,

    "node_backend_stat_stale_timeout": 120,

    "forbidden_dht_groups": false,
    "forbidden_dc_sharing_among_groups": false,
    "forbidden_ns_without_settings": false,
    "forbidden_unmatched_group_total_space": false,

    "couple_build": {
        "default_group_total_space": "916G"
    },

    "cocaine_app_profiles": {
        "mastermind2.26": {
            "pool-limit": 5,
            "spawn-timeout": 120,
            "heartbeat-timeout": 60,
            "handshake-timeout": 30
        },

        "mastermind2.26-cache": {
            "pool-limit": 1,
            "spawn-timeout": 120,
            "heartbeat-timeout": 60,
            "handshake-timeout": 30
        },

        "mastermind2.26-inventory": {
            "pool-limit": 1,
            "spawn-timeout": 20,
            "heartbeat-timeout": 40,
            "handshake-timeout": 5
        }
    },

    "restore": {
        "rsync_use_module": true,
        "rsync_module": "storage",
        "rsync_user": "rsync",
        "group_file": "kdb/group.id",
        "group_file_marker": "kdb/group_old.{group_id}",
        "group_file_dir_move_src_rename": "migrate",
        "group_file_dir_move_dst_rename": "migrate_dst",
        "ids_file": "kdb/ids",

        "merge_group_file_marker": "kdb/merged_with_group_{dst_group_id}_backend_{dst_backend_id}.lock",
        "merge_group_file_dir_move_src_rename": "merged",

        "move_additional_files": [["kdb/device.conf", "kdb/device.conf"]],
        "restore_additional_files": [["kdb/device.conf", "kdb/device.conf"]],

        "backend_down_marker": "backends/{backend_id}.down",
        "backend_stop_marker": "backends/{backend_id}.stop"
    },

    "backend_commands": {
        "group_file": "kdb/group.id",
        "backend_cleanup_group_file_dir_rename": "removed"
    },

    "minions": {
        "authkey": "SetSomeSecureAuthKey",
        "port": 8081,
        "commands_fetch_period": 120,
        "commands_fetch_timeout": 15,
        "active_fetch_period": 5,
        "history_fetch_period": 120,
        "request_timeout": 5.0
    },

    "metadata": {
        "url": "mongodb://localhost:27017/?replicaSet=mastermind-cloud",
        "options": {
            "max_pool_size": 100,
            "socketTimeoutMS": 5000,
            "connectTimeoutMS": 5000,
            "w": 2,
            "wtimeout": 5000
        },

        "couples": {
            "db": "mastermind_couples"
        },
        "groups": {
            "db": "mastermind_groups"
        },
        "jobs": {
            "db": "mastermind_jobs"
        },
        "external_storage": {
            "db": "mastermind_external_storage"
        },
        "planner": {
            "db": "mastermind_planner"
        },
        "cache": {
            "db": "mastermind_cache"
        },
        "history": {
            "db": "mastermind_history"
        },
        "namespaces": {
            "db": "mastermind_namespaces"
        },
        "minions": {
            "db": "mastermind_minions"
        }

        "statistics" {
            "db": "mastermind_statistics",
            "write_attempts": 3,
            "couple_free_effective_space": {
                "collect_period": 300,
                "max_data_points": 1000,
                "record_ttl": 31536000  # 60 * 60 * 24 * 365
            }
        }
    },

    "planner": {
        "move": {
            "enabled": true,
            "autoapprove": false,
            "generate_plan_period": 1800,
            "max_plan_length": 5,
            "uncoupled_space_min_limit_bytes": 2251799813685248,  # 2 PiB
            "uncoupled_space_max_limit_bytes": 11258999068426240,  # 10 PiB
        },

        "recover_dc": {
            "enabled": true,
            "recover_dc_period": 900,
            "jobs_batch_size": 10,
            "autoapprove": True,
            "keys_cf": 86400,
            "timestamp_cf": 1
        },

        "couple_defrag": {
            "enabled": true,
            "couple_defrag_period": 900,
            "jobs_batch_size": 10,
            "autoapprove": True
        },

        "ttl_cleanup": {
            "enabled": true,
            "aggregation_table": "",
            "tskv_log_table": "",
            "ttl_cleanup_period": 9000,
            "yt_cluster": "",
            "yt_token": "",
            "yt_attempts": 5,
            "yt_delay": 900,
            "autoapprove": true,
            "ttl_threshold": 1000
        },

        "external_storage_converting": {
            "enabled": true,
            "generate_plan_period": 1800,
            "convert_groupset": {
                "type": "lrc",
                "settings": {
                    "scheme": "lrc-8-2-2-v1",
                    "part_size": 1048576
                }
            },
            "limits": {
                "per_host": 1,
                "dcs": []      # no restrictions if not set or empty array
            },

            # sleep period after groupset creation and announcing it
            # in external storage mapping
            "groupset_creation_sleep_period": 600,

            "autoapprove": false
        },

        "lrc_reserve": {
            "enabled": true,
            "generate_plan_period": 3600,
            "reserved_space_per_dc": "1T",

            # use only uncoupled groups that have one of total space values described below,
            # can be omitted
            "uncoupled_groups_total_space": ["916G"],

            "autoapprove": false
        }
    },

    "scheduler": {
        "enabled": true,
        "recover_dc": {
            "enabled": true,
            "recover_dc_period": 900,
            "max_executing_jobs": 10,
            "autoapprove": true,
            "keys_cf": 86400,
            "timestamp_cf": 1,
            "min_key_loss": 1
        },

        "couple_defrag": {
            "enabled": true,
            "couple_defrag_period": 900,
            "max_executing_jobs": 10,
            "autoapprove": true,
            "min_removed_size": 1000
        },

        "ttl_cleanup": {
            "enabled": true,
            "aggregation_table": "",
            "tskv_log_table": "",
            "ttl_cleanup_period": 9000,
            "yt_cluster": "",
            "yt_token": "",
            "yt_attempts": 5,
            "yt_delay": 900,
            "autoapprove": true,
            "ttl_threshold": 1000,
            "max_idle_days": 21
        },

        "move": {
            "enabled": true,
            "move_period": 36000,
            "autoapprove": false,
            "uncoupled_space_max_bytes": 0,
            "uncoupled_diff_sensitive_percent": 1,
            "uncoupled_space_min_bytes": 10000000000
        },

    "jobs": {
        "enabled": true,
        "update_period": 50,
        "execute_period": 60,
        "recover_dc_job": {
            "max_executing_jobs": 10,
            "resources_limits": {
                "fs": 2,
                "host_in": 2,
                "host_out": 2
            }
        },
        "move_job": {
            "max_executing_jobs": 10,
            "resources_limits": {
                "fs": 1,
                "host_in": 2,
                "host_out": 2
            }
        },
        "restore_group_job": {
            "max_executing_jobs": 10,
            "resources_limits": {
                "fs": 1,
                "host_in": 2,
                "host_out": 2
            }
        },
        "couple_defrag_job": {
            "max_executing_jobs": 10,
            "resources_limits": {
                "fs": 1,
                "cpu": 4
            }
        },
        "convert_to_lrc_groupset_job": {
            "max_executing_jobs": 10,
            "resources_limits": {
                "cpu": 10
            }
        },
        "minions": {
            "execute_attempts": 3
        }
    },

    "sync": {
        "class": "sync.fake_sync.SyncManager"
    },

    "cache": {
        "top_update_period": 1800,

        "manager": {
            "class": "sync.cache_transport.fake_transport.Transport"
        },

        "cleaner": {
            "expand_threshold": 21600,
            "dirty_coef_threshold": 0.6
        }

        "group_path_prefix": "/srv/storage/cache/",
        "bandwidth_per_copy": 5242880,
        "max_node_network_bandwidth": 104857600,

        "copies_reduce_factor": 0.66,
        "copies_expand_step": 1,

        "dryrun": false
    }

    "total_space_diff_tolerance": 0.05,

    "inventory": "fake_inventory",
    "symm_group_read_gap": 1,
    "couple_read_gap": 1,
    "nodes_reload_period": 60,
    "storage_cache_valid_time": 600,

    "infrastructure_sync_period": 60,
    "infrastructure_ns_settings_sync_period": 60,

    "infrastructure_dc_cache_valid_time": 604800,
    "infrastructure_dc_cache_update_period": 150,

    "infrastructure_hostname_cache_valid_time": 604800,
    "infrastructure_hostname_cache_update_period": 600,

    "infrastructure_hosttree_cache_valid_time": 604800,
    "infrastructure_hosttree_cache_update_period": 600,

    "infrastructure": {
        "recovery_dc": {
            # vars to use:
            # {group_id} - group id, e.g. 69
            # {group_base_path} - base path of a group backend, e.g. "/var/storage/1/2/"
            "tmp_dir": "/var/tmp/dnet_recovery_dc_{group_id}",
            "attempts": 1,
            "batch": 2000,
            "log": "dnet_recovery.log",
            "log_level": 1
        },
        "lrc_convert": {
            "tmp_dir": "/var/tmp/lrc_convert_{couple_id}",
            "attempts": 1,
            "log": "lrc_convert.log",
            "log_level": 1
        },
        "lrc_validate": {
            "tmp_dir": "/var/tmp/lrc_validate_{couple_id}",
            "attempts": 1,
            "log": "lrc_validate.log",
            "log_level": 1
        },
        "ttl_cleanup":{
            "attempts": 5,
            "nproc": 5,
            "batch_size": 30,
            "log": 'ttl_cleanup.log',
            "tmp_dir": '/var/tmp/',
            "tskv_log_file": 'syslog'
        },
        "recovery_dc_lrc": {
            "tmp_dir": "/var/tmp/dnet_recovery_lrc_{couple_id}",
            "attempts": 1,
            "batch": 2000,
            "log": "dnet_recovery.log",
            "log_level": 1,
            "user_flag": 1,
        },
        "lrc_recovery": {
            "tmp_dir": "/var/tmp/lrc_recovery_{couple_id}",
            "attempts": 1,
            "log": "lrc_recovery.log",
            "log_level": 1,
            "wait_timeout": 1,
        },
    },

    "inventory_cache": {
        "hostname": {
            "cache_update_period": 600,
            "key_valid_time": 604800,
            "key_retry_time": 600,
            "path": "/var/tmp/mastermind.hostname.cache"
        },
        "hosttree": {
            "cache_update_period": 600,
            "key_valid_time": 604800,
            "key_retry_time": 600,
            "path": "/var/tmp/mastermind.hosttree.cache"
        },
        "ip_addresses": {
            "cache_update_period": 600,
            "key_valid_time": 604800,
            "key_retry_time": 600,
            "path": "/var/tmp/mastermind.ip_addresses.cache"
        }
    },

    "fallback_hosts_per_dc": 10,

    "balancer_config": {
        "min_units": 1,
        "add_units": 1
    },

    "weight": {
        "resource_unit_disk_util": 0.05,
        "resource_unit_disk_write_rate": 5242880,  # 5Mb/s
        "add_resource_units_relative": 0.15,
        "add_resource_units_absolute": 0.20,
        "min_units": 1,
        "add_units": 1,

        "net": {
            "write_rate_threshold": 73400320,   # 70Mb/s
            "read_rate_threshold": 73400320,   # 70Mb/s
            "max_write_rate": 104857600,        # 100Mb/s, maximum net write rate
        },
        "disk": {
            "disk_util_threshold": 0.4,
        },
    },

    "lrc": {
        "lrc-8-2-2-v1": {
            "lrc_groups_per": {
                "host": 1
            },
            "group_total_space": "114G",
            "uncoupled_groups_total_space": ["916G"],
            "restore": {
                "external_storage_validation": false
            }
        }
    },
}
